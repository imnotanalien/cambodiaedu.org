{% load i18n %}
{% load static %}
{% load sekizai_tags %}

{% get_current_language as LANGUAGE_CODE %}
{% get_available_languages as LANGUAGES %}
{% get_language_info_list for LANGUAGES as languages %}


{% addtoblock "css" %}
    <link rel="stylesheet" href="{% static "src/include/navbar-calculator/navbar-calculator.css" %}">
{% endaddtoblock %}

<nav class="navbar-calculator">
    <a href="{% url "calculator" %}" class="navbar-calculator-logo-a">
        <img class="navbar-calculator-logo" src="{% static "assets/images/icon.png" %}" alt="">
        <span class="navbar-calculator-name">Calculator</span>
    </a>
    <ul class="navbar-calculator-ul">
        {% if LANGUAGE_CODE == "en" %}
            <li><a class="navbar-calculator-links" href="{% url "basic-calculator" %}">Basic</a></li>
            <li><a class="navbar-calculator-links" href="{% url "graphing-calculator" %}">Graphing</a></li>
            <li><a class="navbar-calculator-links" href="{% url "geometry-calculator" %}">Geometry</a></li>
            <li><a class="navbar-calculator-links" href="{% url "probability-calculator" %}">Probability</a></li>
        {% endif %}
        {% if LANGUAGE_CODE == "km" %}
            <li><a class="navbar-calculator-links" href="{% url "basic-calculator" %}">មាសុីនគិតលេខ</a></li>
            <li><a class="navbar-calculator-links" href="{% url "graphing-calculator" %}">ក្រាហ្វ​</a></li>
            <li><a class="navbar-calculator-links" href="{% url "geometry-calculator" %}">ធរណីមាត្រ</a></li>
            <li><a class="navbar-calculator-links" href="{% url "probability-calculator" %}">ប្រូបាប</a></li>
        {% endif %}
    </ul>

    {% comment %} Dropdown menu {% endcomment %}
    <div class="dropdown-menu">
        <button class="dropbtn" onclick="btnDropdownFunc()" aria-label="More menu button">
            More
            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
                <path d="M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"/>
            </svg>
        </button>
        
        <ul class="dropdown-content" id="myDropdown">
            <li class="dropdown-menu-items">
                <a class="navbar-calculator-links" href="{% url "basic-calculator" %}">Basic</a>
            </li>
            <li class="dropdown-menu-items">
                <a class="navbar-calculator-links" href="{% url "graphing-calculator" %}">Graphing</a>
            </li>
            <li class="dropdown-menu-items">
                <a class="navbar-calculator-links" href="{% url "geometry-calculator" %}">Geometry</a>
            </li>
            <li class="dropdown-menu-items">
                <a class="navbar-calculator-links" href="{% url "probability-calculator" %}">Probability</a>
            </li>
        </ul>
    </div>

    {% comment %} Right menu {% endcomment %}
    <div style="
        width: 170px;
        position: relative;
        right: .6rem;
        display: flex;
        align-items: center;
        margin-left: auto;
        justify-content: space-between;
    ">
        {% comment %} Dropdown user menu {% endcomment %}
        <div class="profile-dropdown-btn" id="UserProfileDropdownBtn" onclick="toggle()">
            {% comment %} <svg xmlns="http://www.w3.org/2000/svg" height="32" viewBox="0 -960 960 960" width="32">
                <path d="M234-276q51-39 114-61.5T480-360q69 0 132 22.5T726-276q35-41 54.5-93T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 59 19.5 111t54.5 93Zm246-164q-59 0-99.5-40.5T340-580q0-59 40.5-99.5T480-720q59 0 99.5 40.5T620-580q0 59-40.5 99.5T480-440Zm0 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q53 0 100-15.5t86-44.5q-39-29-86-44.5T480-280q-53 0-100 15.5T294-220q39 29 86 44.5T480-160Zm0-360q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm0-60Zm0 360Z"/>
            </svg> {% endcomment %}
        </div>

        {% comment %} Theme light and dark {% endcomment %}
        {% include "src/include/theme-btn/theme-btn.html" %}
        
        {% comment %} Dropdown languages {% endcomment %}
        <div class="lang-dropdown">
            <button class="btn-lang-dropdown" onclick="changeLanguageFunc()" aria-label="Dropdown menu">
                <svg class="lang-dropdown-svg" xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 -960 960 960" width="30">
                    <path d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-155.5t86-127Q252-817 325-848.5T480-880q83 0 155.5 31.5t127 86q54.5 54.5 86 127T880-480q0 82-31.5 155t-86 127.5q-54.5 54.5-127 86T480-80Zm0-82q26-36 45-75t31-83H404q12 44 31 83t45 75Zm-104-16q-18-33-31.5-68.5T322-320H204q29 50 72.5 87t99.5 55Zm208 0q56-18 99.5-55t72.5-87H638q-9 38-22.5 73.5T584-178ZM170-400h136q-3-20-4.5-39.5T300-480q0-21 1.5-40.5T306-560H170q-5 20-7.5 39.5T160-480q0 21 2.5 40.5T170-400Zm216 0h188q3-20 4.5-39.5T580-480q0-21-1.5-40.5T574-560H386q-3 20-4.5 39.5T380-480q0 21 1.5 40.5T386-400Zm268 0h136q5-20 7.5-39.5T800-480q0-21-2.5-40.5T790-560H654q3 20 4.5 39.5T660-480q0 21-1.5 40.5T654-400Zm-16-240h118q-29-50-72.5-87T584-782q18 33 31.5 68.5T638-640Zm-234 0h152q-12-44-31-83t-45-75q-26 36-45 75t-31 83Zm-200 0h118q9-38 22.5-73.5T376-782q-56 18-99.5 55T204-640Z"/>
                </svg>

                {% for language in languages %}
                    {% if LANGUAGE_CODE == language.code %}
                        {{ language.code }}
                    {% endif %}
                {% endfor %}

                <svg class="lang-dropdown-svg-arrow" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 320 512">
                    <path d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/>
                </svg>
            </button>

            <ul class="lang-dropdown-content" id="langDropdown">
                {% for language in languages %}
                    <li>
                        {% comment %} <a href="/{{ lang.code }}/">{{ lang.name_local }}</a> {% endcomment %}
                        <a href="/{{ language.code }}/{{request.get_full_path|slice:"4:"}}">{{ language.name_local }}</a>
                    </li>
                {% endfor %}
            </ul>
        </div>
        
        {% comment %} User profile dropdown menu {% endcomment %}
        <div class="navbar-user-dropdown" id="user-dropdown">
            <div class="navbar-user-dropdown-list"></div>

            <div class="profile-dropdown">
                <ul class="profile-dropdown-list">
                    {% comment %} If user not logged in yet {% endcomment %}
                    <li class="profile-dropdown-list-item" id="userLogin">
                        <a href="{% url "login" %}">
                            <svg class="dropdown-icon-items" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
                                <path d="M480-120v-80h280v-560H480v-80h280q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H480Zm-80-160-55-58 102-102H120v-80h327L345-622l55-58 200 200-200 200Z"/>
                            </svg>
                            <span>Log in</span>
                        </a>
                    </li>
                    <li class="profile-dropdown-list-item" id="userSignUp">
                        <a href="{% url "signup" %}">
                            <svg class="dropdown-icon-items" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
                                <path d="M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"/>
                            </svg>
                            <span>Sign up</span>
                        </a>
                    </li>
                    <li class="profile-dropdown-list-item" id="userProfile">
                        {% comment %} <a href="/densok">
                            <svg class="dropdown-icon-items" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
                                <path d="M234-276q51-39 114-61.5T480-360q69 0 132 22.5T726-276q35-41 54.5-93T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 59 19.5 111t54.5 93Zm246-164q-59 0-99.5-40.5T340-580q0-59 40.5-99.5T480-720q59 0 99.5 40.5T620-580q0 59-40.5 99.5T480-440Zm0 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q53 0 100-15.5t86-44.5q-39-29-86-44.5T480-280q-53 0-100 15.5T294-220q39 29 86 44.5T480-160Zm0-360q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm0-60Zm0 360Z"/>
                            </svg>
                            <span>Profile</span>
                        </a> {% endcomment %}
                    </li>

                    {% comment %} If user logged in {% endcomment %}
                    <li class="profile-dropdown-list-item" id="userLogout">
                        <form action="/api/user/logout/" method="post" id="logoutForm">{% csrf_token %}
                            <button type="submit">
                                <svg class="dropdown-icon-items" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
                                    <path d="M480-120v-80h280v-560H480v-80h280q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H480Zm-80-160-55-58 102-102H120v-80h327L345-622l55-58 200 200-200 200Z"/>
                                </svg>
                                Log out
                            </button>
                        </form>
                    </li>
                </ul>

            </div>
        </div>
        {% comment %} End {% endcomment %}
    </div>
</nav>

{% addtoblock "js" %}
    <script src="{% static "src/include/navbar-calculator/navbar-calculator.js" %}"></script>
{% endaddtoblock %}
